<div class="container">
    <div class="table-responsive">
        <table class="table">
          <thead class=" text-primary">
            <th>
                ID Ducto
            </th>
            <th>
                Numero de Tramo
            </th>
            <th>
                ID de Fabricación
            </th>
            <th>
               Tipo Material
           </th>
           <th>
             Fecha Montaje
         </th>
           <th>
             Girado
           </th>
           <th>
             Linea
           </th>
            <th>
                Anillos
            </th>

            <th >
             Código QR
             </th>
             <!-- <th >
              Editar
              </th> -->
          </thead>
          <tbody *ngFor="let x of listaDuctos | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage, id: 'custom-pagination' }">
            <tr>
                <td>
                  {{x.id_ducto}}
                </td>
                <td>
                 {{x.N_Tramo}}
                </td>
                <td>
                 {{x.id_fabricacion}}
                </td>
                <td>
                 {{obtenerTipoMaterialPorId(x.id_tipo_material)}}
                </td>
                <td>
                 {{formatearFecha(x.fecha_montaje)}}
                </td>
                <td>
                 {{x.girado == 1 ? 'SI':'NO'}}
                </td>
                <td>
                 {{obtenerLineasPorId(x.id_linea)}}
                </td>

                <td >
                 <div class="row">
                  <div class="col-4">
                    <button class="btn btn-info" (click)="openModalAnillos(x.id_ducto,'A',x.N_Tramo)">
                      <b>A</b>
                   </button>
                  </div>
                  <div class="col-4">
                    <button class="btn btn-success" (click)="openModalAnillos(x.id_ducto,'B',x.N_Tramo)">
                     <b>B</b>
                    </button>
                  </div>

                  <div class="col-4">
                    <button class="btn  btn-secondary" (click)="openModalAnillos(x.id_ducto,'C',x.N_Tramo)">
                      <b>C</b>
                    </button>
                  </div>
                 </div>
                </td>
                <td style="padding-left:20px;">
                  <button type="button" class="btn btn-light" (click)="abrirModalQr(x.id_ducto)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-qr-code" viewBox="0 0 16 16">
                      <path d="M2 2h2v2H2z"/>
                      <path d="M6 0v6H0V0zM5 1H1v4h4zM4 12H2v2h2z"/>
                      <path d="M6 10v6H0v-6zm-5 1v4h4v-4zm11-9h2v2h-2z"/>
                      <path d="M10 0v6h6V0zm5 1v4h-4V1zM8 1V0h1v2H8v2H7V1zm0 5V4h1v2zM6 8V7h1V6h1v2h1V7h5v1h-4v1H7V8zm0 0v1H2V8H1v1H0V7h3v1zm10 1h-1V7h1zm-1 0h-1v2h2v-1h-1zm-4 0h2v1h-1v1h-1zm2 3v-1h-1v1h-1v1H9v1h3v-2zm0 0h3v1h-2v1h-1zm-4-1v1h1v-2H7v1z"/>
                      <path d="M7 12h1v3h4v1H7zm9 2v2h-3v-1h2v-1z"/>
                    </svg>
                  </button>
                </td>
                <!-- <td style="padding-left:20px;">
                  <button type="button" class="btn btn-warning" (click)="openModalEditar(x.id_ducto)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                      <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z"/>
                    </svg>
                  </button>
                </td> -->
            </tr>
          </tbody>
        </table>
        <!-- <pagination-controls (pageChange)="pageChanged($event)" id="custom-pagination"></pagination-controls> -->
        <div class="row">
          <div class="col-md-4">
              <!-- Botón para imprimir PDF -->
              <button class="btn btn-primary" (click)="this.imprimirQR()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-qr-code" viewBox="0 0 16 16">
                  <path d="M2 2h2v2H2z"/>
                  <path d="M6 0v6H0V0zM5 1H1v4h4zM4 12H2v2h2z"/>
                  <path d="M6 10v6H0v-6zm-5 1v4h4v-4zm11-9h2v2h-2z"/>
                  <path d="M10 0v6h6V0zm5 1v4h-4V1zM8 1V0h1v2H8v2H7V1zm0 5V4h1v2zM6 8V7h1V6h1v2h1V7h5v1h-4v1H7V8zm0 0v1H2V8H1v1H0V7h3v1zm10 1h-1V7h1zm-1 0h-1v2h2v-1h-1zm-4 0h2v1h-1v1h-1zm2 3v-1h-1v1h-1v1H9v1h3v-2zm0 0h3v1h-2v1h-1zm-4-1v1h1v-2H7v1z"/>
                  <path d="M7 12h1v3h4v1H7zm9 2v2h-3v-1h2v-1z"/>
                </svg>
                  QR masivo
              </button>
          </div>
          <div class="col-md-4">
            <!-- Botón para imprimir PDF -->
            <button class="btn btn-success" (click)="openModalIngresar()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-printer" viewBox="0 0 16 16">
                    <path d="M0 1V4H16V1H0zM15 5H1v8h14V5zM1 13V15h14v-2H1zm5-7H4v-1h2v1zM3 9h2v1H3V9z"/>
                </svg>
                Ingresar Ductos
            </button>
        </div>
          <div class="col-md-4">
              <!-- Paginador ... -->
              <pagination-controls (pageChange)="pageChanged($event)" id="custom-pagination"></pagination-controls>
          </div>
      </div>
      </div>
</div>

<div *ngIf="modalQr" class="overlay">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Generar QR de Ducto</h5>
        <button type="button" class="close"  (click)="closeModalQR()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="modal-body">
          <ngx-qrcode
          [elementType]="elementType"
          [value]="ductoUrl"
          cssClass="aclass"
          errorCorrectionLevel="L">
        </ngx-qrcode>
        </div>
      </div>
      <div class="modal-footer">
        <!-- Botones para acciones en el modal -->
        <button class="btn btn-primary" style="margin: 20px;" (click)="downloadPDF(this.id_descarga)" >Descargar QR</button>
        <button class="btn btn-danger" style="margin: 20px;" (click)="closeModalQR()" >Cancelar</button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="modalIngreasrDuctos" class="overlay">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Ingresar Ductos</h5>
        <button type="button" class="close"  (click)="closeModalIngresar()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-6">
            <label for="">ID Ducto : </label>
            <input type="text" [(ngModel)]="idDucto">
          </div>
          <div class="col-6">
            <label for="">ID Fabricacion: </label>
            <input type="text" [(ngModel)]="idFabricacion">
          </div>
        </div>
        <div class="row" style="padding-top: 7px;">
          <div class="col-6">
            <label for="tipoMaterial">Tipo Material</label>
            <select id="tipoMaterial" class="form-control" [(ngModel)]="tipoMaterialSeleccionado">
              <option *ngFor="let x of tipoMaterial" [value]="x.nombre">{{x.nombre}}</option>
              <!-- Agrega más opciones según sea necesario -->
            </select>
          </div>
        
          <div class="col-6">
            <label for="fechaMontaje">Fecha Montaje</label>
            <input type="text" [(ngModel)]="fechaMontaje">
          </div>
        </div>

         <div class="row" style="padding-top: 7px;">
          <div class="col-6">
            <label for="linea">Linea</label>
            <select  id="linea" class="form-control" [(ngModel)]="lineaSeleccionada">
              <option *ngFor="let x of lineas" [value]="x.nombre">{{x.nombre}}</option>
              <!-- Agrega más opciones según sea necesario -->
            </select>
          </div>
        
          <div class="col-6">
            <label for="fechaMontaje">Numero Tramo</label>
            <input type="text" [(ngModel)]="numeroTramo">
          </div>
        </div>

        <div class="row" style="padding-top: 7px;">
          <div class="col-12">
            <label for="tipoMaterial">Girado</label>
            <select id="tipoMaterial" class="form-control" [(ngModel)]="girado">
              <option value="SI">SI</option>
              <option value="NO">NO</option>
              <!-- Agrega más opciones según sea necesario -->
            </select>
          </div>
        </div>
        
        <!-- <div class="modal-body">
          <ngx-qrcode
          [elementType]="elementType"
          [value]="ductoUrl"
          cssClass="aclass"
          errorCorrectionLevel="L">
        </ngx-qrcode>
        </div> -->
      </div>
      <div class="modal-footer">
        <!-- Botones para acciones en el modal -->
        <button class="btn btn-success" style="margin: 20px;" (click)="guardarDatos()">Ingresar ducto</button>
        <button class="btn btn-danger" style="margin: 20px;" (click)="closeModalIngresar()">Cancelar</button>
      </div>
    </div>
  </div>
</div>



<!-- modal-edicion-ducto.component.html -->
<!-- modal-edicion-ducto.component.html -->
<div *ngIf="modalEditarDuctos" class="overlay">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Ductos</h5>
        <button type="button" class="close" (click)="closeModalEditar()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div *ngFor="let y of ductoEditar" class="modal-body">
        <div class="row">
          <div class="col-6">
            <label for="">ID Ducto : </label>
            <input type="text" class="form-control" id="IdDucto" [(ngModel)]="y.id_ducto">
          </div>
          <div class="col-6">
            <label for="">ID Fabricación: </label>
            <input type="text" class="form-control" id="IdFabricacion" [(ngModel)]="y.id_fabricacion">
          </div>
        </div>
        <div class="row" style="padding-top: 7px;">
          <div class="col-6">
            <label for="tipoMaterial">Tipo Material</label>
            <select id="tipoMaterial" class="form-control" [(ngModel)]="y.id_tipo_material">
              <option *ngFor="let x of tipoMaterial" [value]="x.id">{{x.nombre}}</option>
              <!-- Agrega más opciones según sea necesario -->
            </select>
          </div>
        
          <div class="col-6">
            <label for="fechaMontaje">Fecha Montaje</label>
            <input type="text" class="form-control" [(ngModel)]="y.fecha_montaje">
          </div>
        </div>

         <div class="row" style="padding-top: 7px;">
          <div class="col-6">
            <label for="tipoMaterial">Linea</label>
            <select id="tipoMaterial" class="form-control" [(ngModel)]="y.id_linea">
              <option *ngFor="let x of lineas" [value]="x.id">{{x.nombre}}</option>
              <!-- Agrega más opciones según sea necesario -->
            </select>
          </div>
        
          <div class="col-6">
            <label for="fechaMontaje">Numero Tramo</label>
            <input type="text" class="form-control" [(ngModel)]="y.N_Tramo">
          </div>
        </div>

        <div class="row" style="padding-top: 7px;">
          <div class="col-12">
            <label for="tipoMaterial">Girado</label>
            <select id="tipoMaterial" class="form-control" [(ngModel)]="y.girado">
              <option value="0">NO</option>
              <option value="1">SI</option>
              <!-- Agrega más opciones según sea necesario -->
            </select>
          </div>
        </div>
        
        <!-- <div class="modal-body">
          <ngx-qrcode
          [elementType]="elementType"
          [value]="ductoUrl"
          cssClass="aclass"
          errorCorrectionLevel="L">
        </ngx-qrcode>
        </div> -->
      </div>
      <div class="modal-footer">
        <!-- Botones para acciones en el modal -->
        <button class="btn btn-success" style="margin: 20px;"  >Actualizar ducto</button>
        <button class="btn btn-danger" style="margin: 20px;" (click)="closeModalEditar()" >Cancelar</button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="modalAnillos" class="overlay">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Anillo {{this.anilloSeleccionado}} de tramo {{this.tramoSeleccionado}}</h5>
      </div>

      <div class="modal-body">
        <div class="container">
          <div class="row">
            <div class="col-4">
              <label for="">Anillo {{this.medicion}}</label>
            </div>
            <div class="col-4">
              <label for="">Tipo Material: WEARPRO</label>
            </div>
            <div class="col-4">
              <label for="">Diametro: {{this.medicion[0].diametro}}</label>
            </div>
          </div>
          <div class="row">
            <div class="col-4">
              <label for="">Fecha Medicion {{this.medicion[0].Fecha_medicion}}</label>
            </div>
            <div class="col-4">
              <label for="">Espesor Minimo: {{this.medicion[0].Espesor_min}}</label>
            </div>
            <div class="col-4">
              <label for="">Diametro: {{this.medicion[0].tasa_desgaste}}</label>
            </div>
          </div>
          <div class="row">
            <div class="col-4">
              <label for="">Fecha Medicion {{this.medicion[0].Fecha_medicion}}</label>
            </div>
            <div class="col-4">
              <label for="">Espesor Minimo: {{this.medicion[0].Espesor_min}}</label>
            </div>
            <div class="col-4">
              <label for="">Diametro: {{this.medicion[0].tasa_desgaste}}</label>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <!-- Botones para acciones en el modal -->
        <!-- <button class="btn btn-success" style="margin: 20px;"  >Actualizar ducto</button> -->
        <button class="btn btn-danger" style="margin: 20px;" (click)="closeModalAnillos()" >Cerrar</button>
      </div>
    </div>
  </div>
</div>

<div class="overlay" *ngIf="spinner">
  <div class="spinner"></div>
</div>


